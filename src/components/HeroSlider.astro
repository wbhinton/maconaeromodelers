---
import type { ImageMetadata } from 'astro';

interface Props {
  title: string;
  subtitle: string;
  images: ImageMetadata[];
}

const { title, subtitle, images } = Astro.props;
---

<div class="relative w-full h-[600px] overflow-hidden rounded-2xl shadow-xl group bg-black">
  
  {images.map((img, index) => (
    <div 
      class={`absolute inset-0 w-full h-full transition-opacity duration-1000 ease-in-out slider-image ${index === 0 ? 'opacity-100' : 'opacity-0'}`}
      data-index={index}
    >
      <img 
        src={img.src} 
        alt="Club Event" 
        class="w-full h-full object-cover"
        loading="eager"
        decoding="sync" 
      />
    </div>
  ))}

  <div class="absolute inset-0 bg-black/60"></div>

  <div class="absolute inset-0 flex flex-col items-center justify-center text-center px-4 z-10">
    <h1 class="text-4xl md:text-6xl font-bold text-white mb-6 drop-shadow-md">
      {title}
    </h1>
    <p class="text-xl md:text-2xl text-gray-200 max-w-3xl drop-shadow-sm">
      {subtitle}
    </p>
    
    <div class="mt-8">
      <a href="/contact" class="bg-primary hover:bg-primary-hover text-white font-bold py-3 px-8 rounded-lg transition-colors shadow-lg border border-white/20">
        Join the Club
      </a>
    </div>
  </div>

</div>

<script>
  const slides = document.querySelectorAll('.slider-image');
  let currentSlide = 0;
  const slideInterval = 5000;

  if (slides.length > 1) {
    setInterval(() => {
      // 1. Fade OUT current
      slides[currentSlide].classList.remove('opacity-100');
      slides[currentSlide].classList.add('opacity-0');

      // 2. Calculate NEXT
      currentSlide = (currentSlide + 1) % slides.length;

      // 3. Fade IN next
      slides[currentSlide].classList.remove('opacity-0');
      slides[currentSlide].classList.add('opacity-100');
    }, slideInterval);
  }
</script>